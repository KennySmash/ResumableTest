(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],d=0,f=[];d<r.length;d++)o=r[d],i[o]&&f.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(f.length)f.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("097d");var n=a("2b0e"),i=a("bc3a"),s=a.n(i),o=a("a7fe"),r=a.n(o),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{},[a("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[a("b-navbar-brand",{attrs:{href:"#"}},[t._v("CloudBurst")]),a("b-button",{staticClass:"ml-auto",on:{click:function(e){t.globalUpload(!0)}}},[t._v("Upload All")]),t._v(" \n      "),a("b-button",{on:{click:function(e){t.pingSocket()}}},[t._v("Socket Server is "),t.socketConnected?a("span",[t._v("📡")]):t._e(),t.socketConnected?t._e():a("span",[t._v("🛑")])]),t._v(" \n      "),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.settingsModal",modifiers:{settingsModal:!0}}]},[t._v("⚙️")]),t._v(" \n      "),a("b-button-group",[a("b-button",[t._v("Bucket Usage :")]),a("b-button",{staticStyle:{width:"250px",height:"38px"}},[a("b-progress",{attrs:{max:t.bucketStats.allowedUsage}},[a("b-progress-bar",{attrs:{value:t.bucketStats.currentUsage,variant:"info",label:""+t.formatFileSize(t.bucketStats.currentUsage,2)}}),t.myFiles?a("b-progress-bar",{attrs:{value:t.queueFileSize,variant:"warning"}}):t._e()],1)],1)],1)],1)],1),t.bucketStats.name?a("div",{staticClass:"container-fluid main-wrapper"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[t.isAbleToUpload?a("b-card",{staticClass:"mb-2",attrs:{title:"Dropzone",tag:"article"}},[a("p",{staticClass:"card-text"},[t._v("\n            Drop your files here\n          ")]),a("input",{attrs:{type:"file",accept:"image/*",multiple:"true"},on:{change:t.onFileChange}})]):a("b-card",{attrs:{title:"You have reached your Bucket Size Limit"}},[a("p",{staticClass:"card-text"},[t._v("Please Contact Guy at text@example.com to organize more space"),a("br"),t._v("Or remove Items from your upload queue")])])],1),a("div",{staticClass:"col-md-6"},[a("b-list-group",{staticClass:"mb-2"},t._l(t.myFiles,function(e){return a("b-list-group-item",{key:e.meta.id,staticClass:"file-list"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3"},[e.state.active||e.state.paused?t._e():a("b-button",{attrs:{size:"sm"},on:{click:function(a){t.startUpload(e.meta.id)}}},[t._v("Start")]),e.state.active&&!e.state.paused?a("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(a){t.pauseUpload(e.meta.id)}}},[t._v("⏸️")]):t._e(),e.state.paused?a("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(a){t.resumeUpload(e.meta.id)}}},[t._v("▶️")]):t._e()],1),a("div",{staticClass:"col-9"},[t._v("\n                "+t._s(e.meta.id)+" : "+t._s(e.meta.name)+" ("+t._s(t.formatFileSize(e.meta.size))+")"),a("br"),a("b-progress",{attrs:{value:t.progressBarVal(e.state.progress),max:e.meta.size,"show-progress":"",animated:e.state.active}}),e.meta.uploadPath?a("a",{attrs:{href:e.meta.uploadPath}},[a("b-img",{attrs:{thumbnail:"",fluid:"",src:e.meta.uploadPath,alt:e.meta.name}})],1):t._e()],1)])])}),1)],1)]),a("b-modal",{attrs:{id:"settingsModal",size:"md",centered:"",title:"Settings","ok-only":""}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-5 col-form-label",attrs:{for:"chunkSize"}},[t._v("Chunk size (in kB)")]),a("div",{staticClass:"col-md-5"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.chunkSize,expression:"chunkSize",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",id:"chunkSize"},domProps:{value:t.chunkSize},on:{input:function(e){e.target.composing||(t.chunkSize=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})])])])],1):a("div",{staticClass:"d-flex justify-content-center align-content-center p-5"},[t._m(0)]),t.bucketStats.name?t._e():a("h1",{staticClass:"text-center"},[t._v("Loading Amazon Bucket Data")])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("span",{staticClass:"loader"},[a("span",{staticClass:"loader-inner"})])])}],u=a("59ad"),d=a.n(u),f=a("a4bb"),m=a.n(f),p=(a("7f7f"),a("ac6a"),{chunkImage:function(t,e,a){var n={};if(void 0!=a){var i=Math.ceil(a.size/t,t),s=0;while(s<i){var o=s*t;n[s]={chunkId:s,file:e,data:a.slice(o,o+t),type:a.type},s++}}return n}}),h={name:"app",mounted:function(){this.axios.defaults.baseURL="//"+window.location.hostname+":3000"},sockets:{connect:function(){this.getBucketStats(),this.socketConnected=!0},disconnect:function(){this.socketConnected=!1},reconnecting:function(){this.socketConnected=!1},pong:function(){this.socketConnected=!0},upload_begin:function(t){console.log("upload_begin",t),this.myFiles[t.file_id].state.active=!0;var e={data:this.myFiles[t.file_id].data[0],meta:this.myFiles[t.file_id].meta,state:this.myFiles[t.file_id].state};this.$socket.emit("upload_chunk",e)},upload_next:function(t){var e=this.myFiles[t.file_id];e.state.progress++;var a={data:this.myFiles[t.file_id].data[t.chunk_id],meta:this.myFiles[t.file_id].meta,state:this.myFiles[t.file_id].state};this.$socket.emit("upload_chunk",a)},upload_done:function(t){console.log("Ding Dong, Files Done",t);var e=this.myFiles[t.file_id];e.state.active=!1,e.state.completed=!0,this.getBucketStats()},s3_done:function(t){console.log("S3 Upload is finished",t),this.myFiles[t.meta.id].meta.uploadPath=t.data.response.Location,this.transferSlots++}},methods:{getBucketStats:function(){var t=this;this.$http.get("/bucketStatus").then(function(e){t.bucketStats=e.data})},pingSocket:function(){this.$socket.emit("ping")},queueUpload:function(t){this.waitingList.push(t)},startQueue:function(){this.transferSlots=this.transferCap},globalUpload:function(t){var e=this;this.myFiles.forEach(function(t){e.queueUpload(t.meta.id)}),this.startQueue()},startUpload:function(t){console.log("starting Upload of ID:",t),this.transferSlots--;var e=this.$socket,a=this.myFiles[t],n={id:a.meta.id,name:a.meta.name,size:a.meta.size,chunk_count:m()(a.data).length,meta:a.meta};e.emit("upload_start",n)},pauseUpload:function(t){this.myFiles[t].state.paused=!0,this.myFiles[t].state.active=!1},resumeUpload:function(t){this.myFiles[t].state.paused=!1,this.myFiles[t].state.active=!0;var e={file_id:t,name:this.myFiles[t].meta.name};this.$socket.emit("upload_resume",e)},onFileChange:function(t){for(var e=0;e<t.target.files.length;e++){var a=t.target.files[e];this.myFiles.push({file:a,meta:{id:this.currentItems,name:a.name,size:a.size,uploadPath:""},state:{progress:0,active:!1,canceled:!1,paused:!1,completed:!1},data:p.chunkImage(this.chunkInBytes,this.currentItems,a)}),this.myFiles[e].meta.mime=this.myFiles[e].data[0].type,this.currentItems++}t.target.files=null},formatFileSize:function(t,e){if(0==t)return"0 Bytes";var a=1e3,n=e||2,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(t)/Math.log(a));return d()((t/Math.pow(a,s)).toFixed(n))+" "+i[s]},progressBarVal:function(t){return t*this.chunkSize*1024}},computed:{isAbleToUpload:function(){return this.bucketStats.currentUsage<this.bucketStats.allowedUsage},queueFileSize:function(){for(var t=0,e=0;this.myFiles.length>e;e++)!0!==this.myFiles[e].state.completed&&(t+=this.myFiles[e].meta.size);return t},chunkInBytes:function(){return 1024*this.chunkSize},currentQueSize:function(){return this.waitingList.length},currentTransferSize:function(){return this.currentTransfers.length}},data:function(){return{bucketStats:{name:"",allowedUsage:0,currentUsage:0},chunkSize:32,socketConnected:!1,currentItems:0,transferCap:4,transferSlots:0,waitingListNumber:0,waitingList:[],myFiles:[]}},watch:{waitingList:function(t){t.length>0&&this.startUpload(t[0])},transferSlots:function(t,e){console.log("transfer Slots changed from ",e," to ",t);for(var a=this.transferSlots;a>0;a--)this.waitingList.length>0&&(this.startUpload(this.waitingList[0]),this.waitingList.splice(0,1))}}},g=h,v=(a("5c0b"),a("2877")),b=Object(v["a"])(g,c,l,!1,null,null,null),k=b.exports,_=a("2f62");n["a"].use(_["a"]);var y=new _["a"].Store({state:{},mutations:{},actions:{}}),S=a("9483");Object(S["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var w=a("9f7b"),F=a("f87c"),C=a("8055"),z=a.n(C);n["a"].config.productionTip=!1,n["a"].config.devtools=!0,n["a"].use(w["a"]),n["a"].use(F["a"],z()("//"+window.location.hostname+":5050")),n["a"].use(r.a,s.a),new n["a"]({store:y,render:function(t){return t(k)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var n=a("5e27"),i=a.n(n);i.a},"5e27":function(t,e,a){}});
//# sourceMappingURL=app.76b3e207.js.map