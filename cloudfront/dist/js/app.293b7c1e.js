(function(t){function e(e){for(var s,o,r=e[0],c=e[1],l=e[2],d=0,f=[];d<r.length;d++)o=r[d],a[o]&&f.push(a[o][0]),a[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,r=1;r<i.length;r++){var c=i[r];0!==a[c]&&(s=!1)}s&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},a={app:0},n=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},1:function(t,e){},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("097d");var s=i("2b0e"),a=i("bc3a"),n=i.n(a),o=i("a7fe"),r=i.n(o),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{},[i("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[i("b-navbar-brand",{attrs:{href:"#"}},[t._v("CloudBurst")]),i("b-button",{staticClass:"ml-auto",on:{click:function(e){t.globalUpload(!0)}}},[t._v("Upload All")]),t._v(" \n      "),i("b-button",{on:{click:function(e){t.pingSocket()}}},[t._v("Socket Server is "),t.socketConnected?i("span",[t._v("📡")]):t._e(),t.socketConnected?t._e():i("span",[t._v("🛑")])]),t._v(" \n      "),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.settingsModal",modifiers:{settingsModal:!0}}]},[t._v("⚙️")]),t._v(" \n      "),i("b-button-group",[i("b-button",[t._v("Bucket Usage :")]),i("b-button",{staticStyle:{width:"250px",height:"38px"}},[i("b-progress",{attrs:{max:t.bucketStats.allowedUsage}},[i("b-progress-bar",{attrs:{value:t.bucketStats.currentUsage,variant:"info",label:""+t.formatFileSize(t.bucketStats.currentUsage,2)}}),t.myFiles?i("b-progress-bar",{attrs:{value:t.queueFileSize,variant:"warning"}}):t._e()],1)],1)],1)],1)],1),t.bucketStats.name?i("div",{staticClass:"container-fluid main-wrapper"},[i("div",{staticClass:"row mb-3"},[i("div",{staticClass:"col-md-6"},[t.isAbleToUpload?i("b-card",{staticClass:"mb-2",attrs:{title:"Dropzone",tag:"article"}},[i("p",{staticClass:"card-text"},[t._v("\n            Drop your files here\n          ")]),i("input",{attrs:{type:"file",accept:"image/*",multiple:"true"},on:{change:t.onFileChange}})]):i("b-card",{attrs:{title:"You have reached your Bucket Size Limit"}},[i("p",{staticClass:"card-text"},[t._v("Please Contact Guy at text@example.com to organize more space"),i("br"),t._v("Or remove Items from your upload queue")])]),t.finishedFiles[0]?i("b-card",{staticClass:"mt-3",attrs:{title:"Completed Uploads"}},t._l(t.finishedFiles,function(e,s){return i("a",{key:s,staticClass:"mr-3 mb-2 d-block",attrs:{target:"_blank",href:e}},[t._v("\n            "+t._s(s)+" : "+t._s(e)+"\n          ")])}),0):t._e()],1),i("div",{staticClass:"col-md-6"},[i("b-list-group",{staticClass:"mb-2"},t._l(t.myFiles,function(e){return e.state.completed?t._e():i("b-list-group-item",{key:e.meta.id,staticClass:"file-list"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-3"},[e.state.active||e.state.paused||e.state.started?t._e():i("b-button",{attrs:{size:"sm"},on:{click:function(i){t.startUpload(e.meta.id)}}},[t._v("Start")]),e.state.active&&!e.state.paused?i("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(i){t.pauseUpload(e.meta.id)}}},[t._v("⏸️")]):t._e(),e.state.paused?i("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(i){t.resumeUpload(e.meta.id)}}},[t._v("▶️")]):t._e()],1),i("div",{staticClass:"col-9"},[t._v("\n                "+t._s(e.meta.id)+" : "+t._s(e.meta.name)+" ("+t._s(t.formatFileSize(e.meta.size))+")"),i("br"),i("b-progress",{attrs:{value:t.progressBarVal(e.state.progress),max:e.meta.size,"show-progress":"",animated:e.state.active}}),e.meta.uploadPath?i("a",{attrs:{href:e.meta.uploadPath}},[i("b-img",{attrs:{thumbnail:"",fluid:"",src:e.meta.uploadPath,alt:e.meta.name}})],1):t._e()],1)])])}),1)],1)]),i("b-modal",{attrs:{id:"settingsModal",size:"md",centered:"",title:"Settings","ok-only":""}},[i("div",{staticClass:"form-group row"},[i("label",{staticClass:"col-md-5 col-form-label",attrs:{for:"chunkSize"}},[t._v("Chunk size (in kB)")]),i("div",{staticClass:"col-md-5"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.chunkSize,expression:"chunkSize",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",id:"chunkSize"},domProps:{value:t.chunkSize},on:{input:function(e){e.target.composing||(t.chunkSize=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})])])])],1):i("div",{staticClass:"d-flex justify-content-center align-content-center p-5"},[t._m(0)]),t.bucketStats.name?t._e():i("h1",{staticClass:"text-center"},[t._v("Loading Amazon Bucket Data")])])},l=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",[i("span",{staticClass:"loader"},[i("span",{staticClass:"loader-inner"})])])}],u=i("59ad"),d=i.n(u),f=i("a4bb"),m=i.n(f),h=(i("7f7f"),i("ac6a"),{chunkImage:function(t,e,i){var s={};if(void 0!=i){var a=Math.ceil(i.size/t,t),n=0;while(n<a){var o=n*t;s[n]={chunkId:n,file:e,data:i.slice(o,o+t),type:i.type},n++}}return s}}),p={name:"app",mounted:function(){this.axios.defaults.baseURL="//"+window.location.hostname+":3000"},sockets:{connect:function(){this.getBucketStats(),this.socketConnected=!0},disconnect:function(){this.socketConnected=!1},reconnecting:function(){this.socketConnected=!1},pong:function(){this.socketConnected=!0},upload_begin:function(t){this.myFiles[t.file_id].state.active=!0;var e={data:this.myFiles[t.file_id].data[0],meta:this.myFiles[t.file_id].meta,state:this.myFiles[t.file_id].state};this.$socket.emit("upload_chunk",e)},upload_next:function(t){var e=this.myFiles[t.file_id];e.state.progress++;var i={data:this.myFiles[t.file_id].data[t.chunk_id],meta:this.myFiles[t.file_id].meta,state:this.myFiles[t.file_id].state};this.$socket.emit("upload_chunk",i)},upload_done:function(t){this.myFiles[t.file_id];this.getBucketStats()},s3_done:function(t){var e=this.waitingList.indexOf(t.meta.id);e>-1&&this.waitingList.splice(e,1),this.myFiles[t.meta.id].state.completed=!0,-1===this.finishedFiles.indexOf(t.data.response.Location)&&this.finishedFiles.push(t.data.response.Location),this.transferSlots++},file_too_big:function(t){console.error("File was too big",t),this.transferSlots++;var e=this.waitingList.indexOf(t.file_id);e>-1&&this.waitingList.splice(e,1),this.myFiles.state.canceled=!0}},methods:{getBucketStats:function(){var t=this;this.$http.get("/bucketStatus").then(function(e){t.bucketStats=e.data})},pingSocket:function(){this.$socket.emit("ping")},queueUpload:function(t){this.waitingList.push(t)},startQueue:function(){this.transferSlots=this.transferCap},globalUpload:function(t){var e=this;this.myFiles.forEach(function(t){t.state.completed||e.queueUpload(t.meta.id)}),this.startQueue()},startUpload:function(t){this.transferSlots--;var e=this.$socket,i=this.myFiles[t],s={id:i.meta.id,name:i.meta.name,size:i.meta.size,chunk_count:m()(i.data).length,meta:i.meta};i.state.completed||i.state.started?this.transferSlots++:(this.myFiles[t].state.started=!0,this.myFiles[t].state.active=!0,e.emit("upload_start",s))},pauseUpload:function(t){this.myFiles[t].state.paused=!0,this.myFiles[t].state.active=!1},resumeUpload:function(t){this.myFiles[t].state.paused=!1,this.myFiles[t].state.active=!0;var e={file_id:t,name:this.myFiles[t].meta.name};this.$socket.emit("upload_resume",e)},onFileChange:function(t){for(var e=0;e<t.target.files.length;e++){var i=t.target.files[e];this.myFiles.push({file:i,meta:{id:this.currentItems,name:i.name,size:i.size,uploadPath:""},state:{progress:0,active:!1,canceled:!1,paused:!1,completed:!1,started:!1},data:h.chunkImage(this.chunkInBytes,this.currentItems,i)}),this.myFiles[e].meta.mime=this.myFiles[e].data[0].type,this.currentItems++}t.target.files=null},formatFileSize:function(t,e){if(0==t)return"0 Bytes";var i=1e3,s=e||2,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(t)/Math.log(i));return d()((t/Math.pow(i,n)).toFixed(s))+" "+a[n]},progressBarVal:function(t){return t*this.chunkSize*1024}},computed:{isAbleToUpload:function(){return this.bucketStats.currentUsage<this.bucketStats.allowedUsage},queueFileSize:function(){for(var t=0,e=0;this.myFiles.length>e;e++)!0!==this.myFiles[e].state.completed&&(t+=this.myFiles[e].meta.size);return t},chunkInBytes:function(){return 1024*this.chunkSize},currentQueSize:function(){return this.waitingList.length},currentTransferSize:function(){return this.currentTransfers.length}},data:function(){return{bucketStats:{name:"",allowedUsage:0,currentUsage:0},chunkSize:32,socketConnected:!1,currentItems:0,transferCap:4,transferSlots:0,waitingListNumber:0,waitingList:[],myFiles:[],finishedFiles:[]}},watch:{waitingList:function(t){t.length>0&&this.startUpload(t[0])},transferSlots:function(t,e){for(var i=this.transferSlots;i>0;i--)this.waitingList.length>1&&(this.startUpload(this.waitingList[0]),this.waitingList.splice(0,1))}}},g=p,v=(i("5c0b"),i("2877")),b=Object(v["a"])(g,c,l,!1,null,null,null),_=b.exports,k=i("2f62");s["a"].use(k["a"]);var y=new k["a"].Store({state:{},mutations:{},actions:{}}),S=i("9483");Object(S["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var w=i("9f7b"),F=i("f87c"),C=i("8055"),z=i.n(C);s["a"].config.productionTip=!1,s["a"].config.devtools=!0,s["a"].use(w["a"]),s["a"].use(F["a"],z()("//"+window.location.hostname+":5050")),s["a"].use(r.a,n.a),new s["a"]({store:y,render:function(t){return t(_)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var s=i("5e27"),a=i.n(s);a.a},"5e27":function(t,e,i){}});
//# sourceMappingURL=app.293b7c1e.js.map